<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cybersecurity Detective Academy</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Welcome Screen -->
    <div id="welcome" class="screen active">
        <h1>🕵️ Cybersecurity Detective Academy</h1>
        <p>Become a cyber detective! Solve three mysteries, earn badges, and learn essential cybersecurity skills.</p>
        <button onclick="showScreen('case-selection')">Start Investigation 🔍</button>
    </div>
    <!-- Case Selection -->
    <div id="case-selection" class="screen">
        <h2>Select Your Case</h2>
        <div class="cases">
            <button onclick="showScreen('password-mystery')">1️⃣ The Weak Password Mystery</button>
            <button onclick="showScreen('phishing-investigation')">2️⃣ The Phishing Email Investigation</button>
            <button onclick="showScreen('secret-message')">3️⃣ The Secret Message Decoder</button>
        </div>
        <button onclick="showScreen('welcome')">← Back</button>
    </div>
    <!-- Case 1: Password Strength Checker -->
    <div id="password-mystery" class="screen">
        <h2>The Weak Password Mystery</h2>
        <p>Type a password and see its strength!</p>
        <input type="text" id="pwInput" placeholder="Enter password">
        <button onclick="checkPassword()">Check Strength</button>
        <div id="pwFeedback"></div>
        <button onclick="showScreen('case-selection')">← Back</button>
    </div>
    <!-- Case 2: Phishing Email Investigation -->
    <div id="phishing-investigation" class="screen">
        <h2>The Phishing Email Investigation</h2>
        <div id="emailList"></div>
        <button onclick="showScreen('case-selection')">← Back</button>
    </div>
    <!-- Case 3: Caesar Cipher Decoder -->
    <div id="secret-message" class="screen">
        <h2>The Secret Message Decoder</h2>
        <p>Decrypt this message: <b id="cipherText"></b></p>
        <label>Shift: <input type="number" id="shiftInput" min="1" max="25" value="3"></label>
        <button onclick="decodeMessage()">Decode</button>
        <div id="decodeFeedback"></div>
        <button onclick="showScreen('case-selection')">← Back</button>
    </div>
    <!-- Progress & Badges -->
    <div id="progress" class="screen">
        <h2>Your Progress</h2>
        <div id="progressBadges"></div>
        <button onclick="showScreen('case-selection')">← Back</button>
    </div>
    <script src="app.js"></script>
</body>
</html>

body {
    font-family: 'Segoe UI', Arial, sans-serif;
    background: #13243B;
    color: #fff;
    margin: 0;
    padding: 0;
}
.screen {
    display: none;
    padding: 2em;
    max-width: 450px;
    margin: 3em auto 0 auto;
    background: #26324F;
    border-radius: 16px;
    box-shadow: 0 4px 24px rgba(0,0,0,0.14);
}
.screen.active {
    display: block;
}
button {
    background: #1a68b3;
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 0.7em 1.5em;
    margin: 1em 0.5em 0 0;
    font-size: 1em;
    cursor: pointer;
    transition: background .2s;
}
button:hover {
    background: #4479e9;
}
input[type="text"], input[type="number"] {
    padding: 0.5em;
    border-radius: 8px;
    border: 1px solid #4479e9;
    width: 220px;
    margin: 0.8em 0 1em 0;
}
.cases button {
    display: block;
    width: 100%;
    margin: 1em 0;
}
#progressBadges .badge {
    margin: 0.5em 0;
    font-size: 1.2em;
    padding: 0.3em 0.8em;
    border-radius: 8px;
    background: #1a68b3;
    display: inline-block;
}
h1, h2 {
    margin-top: 0;
}


// App Data
const emails = [
    {
        subject: "Urgent: Verify Your Bank Account",
        sender: "security@yourbankk.com",
        content: "Click here to verify: http://fake-bank-site.com/verify",
        phishing: true,
        indicators: "Suspicious sender, urgent tone, fake link"
    },
    {
        subject: "Team Meeting Tomorrow",
        sender: "manager@yourcompany.com",
        content: "Quarterly review meeting at 10 AM.",
        phishing: false,
        indicators: "Normal business email"
    },
    {
        subject: "You've Won $1,000,000!",
        sender: "lottery@winbigtoday.net",
        content: "Send us your bank info to claim prize.",
        phishing: true,
        indicators: "Unlikely offer, requests personal info"
    },
    {
        subject: "IT Security Update",
        sender: "it-security@yourcompany.com",
        content: "Read the new cybersecurity policy.",
        phishing: false,
        indicators: "Relevant, professional communication"
    }
];

let badges = [];
// Navigation
function showScreen(id) {
    document.querySelectorAll('.screen').forEach(e => e.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    if (id === 'phishing-investigation') loadEmails();
    if (id === 'progress') showProgress();
    if (id === 'secret-message') document.getElementById('cipherText').innerText = 'WKLV LV D VHFUHW PHVVDJH';
}

// Password checker
function checkPassword() {
    const pw = document.getElementById('pwInput').value;
    let score = 0, feedback = [], strong = false;
    if (pw.length >= 8) { score++; feedback.push("Good length."); }
    if (/[A-Z]/.test(pw)) { score++; feedback.push("Contains uppercase."); }
    if (/[a-z]/.test(pw)) { score++; feedback.push("Contains lowercase."); }
    if (/[0-9]/.test(pw)) { score++; feedback.push("Contains numbers."); }
    if (/[^A-Za-z0-9]/.test(pw)) { score++; feedback.push("Contains special characters."); }
    let msg = score >= 4 ? 'Strong password! 🏅' : score >= 3 ? 'Moderate password.' : 'Weak password!';
    if (score >= 4 && !badges.includes('Password Expert')) badges.push('Password Expert');
    document.getElementById('pwFeedback').innerHTML = `<b>${msg}</b><br>${feedback.join('<br>')}`;
}

// Phishing email game
function loadEmails() {
    const container = document.getElementById('emailList');
    container.innerHTML = '';
    emails.forEach((email, idx) => {
        container.innerHTML += `
        <div style="padding:1em;border-radius:12px;background:#183458;margin-bottom:1em">
            <b>Subject:</b> ${email.subject}<br>
            <b>Sender:</b> ${email.sender}<br>
            <b>Message:</b> ${email.content}<br>
            <button onclick="gradeEmail(${idx},true)">Suspicious</button>
            <button onclick="gradeEmail(${idx},false)">Safe</button>
            <div id="result${idx}"></div>
        </div>`;
    });
}

function gradeEmail(idx, suspicious) {
    const email = emails[idx];
    let correct = suspicious === email.phishing;
    let badgeAwarded = false;
    let msg = correct ? 'Correct! ' : 'Incorrect. ';
    msg += correct
        ? `(${email.indicators})`
        : `Hint: ${email.indicators}`;
    document.getElementById('result' + idx).innerHTML = msg;
    // Check if all phishing emails are correctly marked
    if (document.querySelectorAll('[id^=result]').length === emails.length) {
        let marked = emails.filter((e, i) => document.getElementById('result'+i).innerText.includes('Correct!') === (e.phishing ? true : false));
        if (marked.length === emails.length && !badges.includes('Phishing Hunter')) {
            badges.push('Phishing Hunter');
        }
    }
}

// Caesar Cipher Decoder
function decodeMessage() {
    let cipher = 'WKLV LV D VHFUHW PHVVDJH';
    let shift = parseInt(document.getElementById('shiftInput').value);
    let decoded = cipher.split('').map(ch => {
        let c = ch.charCodeAt(0);
        if (ch.match(/[A-Z]/)) {
            c = ((c - 65 - shift + 26) % 26) + 65;
            return String.fromCharCode(c);
        } else if (ch.match(/[a-z]/)) {
            c = ((c - 97 - shift + 26) % 26) + 97;
            return String.fromCharCode(c);
        } else return ch;
    }).join('');
    let correct = decoded.trim() === 'THIS IS A SECRET MESSAGE';
    if (correct && !badges.includes('Code Breaker')) badges.push('Code Breaker');
    document.getElementById('decodeFeedback').innerHTML = `<b>${decoded}</b> <br> ${correct ? 'Well done! 🏅' : 'Try a different shift.'}`;
}

// Show progress and badges
function showProgress() {
    let container = document.getElementById('progressBadges');
    if (!badges.length) container.innerHTML = 'No badges yet. Complete cases to earn achievements!';
    else container.innerHTML = badges.map(b =>
        `<span class="badge">${b === 'Password Expert' ? '🔐' : b === 'Phishing Hunter' ? '🎣' : b === 'Code Breaker' ? '🔓' : ''} ${b}</span>`
    ).join(' ');
    if (badges.length === 3) container.innerHTML += '<br><span class="badge">🕵️ Cyber Detective (All cases completed!)</span>';
}
